<HTML>

[!
    use lib "/usr/local/apache/lib-perl";
    use News;
!]

[-  
    if ( my( $input ) = keys %fdat ) {
        my( $command, $story ) = split ":", $input;
        
        if ( $command eq "new" ) {
            $http_headers_out{Location} = "edit_article.epl";
            exit;
        }
        elsif ( $command eq "edit" ) {
            $http_headers_out{Location} = "edit_article.epl?story=$story";
            exit;
        }
        elsif ( $command eq "delete" ) {
            News::delete_story( $story );
        }
        else {
            die "Invalid input: $input"
        }
    }
    
    @stories = News::get_stories()
-]

<HEAD>
  <TITLE>What's New Administration</TITLE>
</HEAD>

<BODY BGCOLOR="white">
  <FORM METHOD="POST">
    <H2>What's New Administration</H2>
    
    <P>Here you can edit and delete existing stories as well as create
      new stories. Clicking on a headline will take you to that article
      in the public area; you will need to use your browser's Back button
      to return.</P>
    <HR>
    
    <TABLE BORDER=1>
    <TR>
      [- ( $story, $headline, $date ) = @{ $stories[$row] } if $stories[$row] -]
      <TD>
        <INPUT TYPE="submit" NAME="edit:[+ $story +]" VALUE="Edit">
        <INPUT TYPE="submit" NAME="delete:[+ $story +]" VALUE="Delete"
          onClick="return confirm('Are you sure you want to delete this?')">
      </TD>
      <TD>
        <A HREF="../article.epl?story=[+ $story +]">[+ $headline +]</A>
        <I>[+ $date +]</I>
      </TD>
    </TR>
    </TABLE>
    
    <INPUT TYPE="submit" NAME="new" VALUE="Create New Story">
    
  </FORM>

  <HR>
  <P>Go to <A HREF="../news.epl">What's New</A>.</P>

</BODY>
</HTML>
